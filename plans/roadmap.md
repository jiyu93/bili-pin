# Bili Pin Roadmap

## v0.0.1（进行中）

### ✅ 已完成
- 动态页 `https://t.bilibili.com/` 注入“置顶UP”栏
- 在关注UP推荐列表注入“置顶/已置顶”按钮（可置顶/取消置顶）
- 置顶数据本地持久化（`chrome.storage.local`）
- 置顶UP栏展开/收起功能（记住状态）
- 置顶UP栏显示总数
- 置顶UP栏hover显示“已置顶”按钮，可取消置顶

### 🐛 已知Bug（待修复）
- ✅ **核心问题已修复**：点击置顶UP头像时，即使该UP不在“关注UP推荐列表”里，也能触发Feed刷新
  - 实现：拦截 `portal` 拿到推荐横条的 `mid`；在 `world: 'MAIN'` 改写 `feed/*` 的 `host_mid`，再触发一次站内刷新（不跳转 space 页）
  - 额外修复：保证置顶栏内部连续切换时每次都能触发刷新（点击非 active 推荐UP item，必要时“全部动态→UP”两段式）
  - 退出筛选态：用户点推荐UP/tabs 时在 capture 阶段清空 `desiredHostMid`，避免“要点两次”
- ✅ **高亮缺失已修复（置顶栏）**：置顶UP栏已实现蓝色圆框+蓝色文字；推荐横条点击时会同步置顶栏高亮/清空高亮

### 📋 待实现功能
- [ ] 置顶UP栏支持拖拽排序（排序仍存本地）
- [ ] （可选优化）点击置顶UP后，同步高亮推荐横条中对应UP（若该UP存在于推荐横条）

## v0.0.2（计划）
- [ ] 关注列表按关注时间筛选

### 验收标准
- 在至少 3 次刷新/切换路由后，置顶栏与按钮仍能正确注入且不重复
- 定位失败时不影响页面正常使用，并能提供足够的诊断信息用于修复


